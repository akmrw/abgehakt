(()=>{var A=(k,l)=>()=>(l||k((l={exports:{}}).exports,l),l.exports);var x=A((M,S)=>{S.exports={BIN_ID:"6825827b8561e97a50143be1",API_KEY:"$2a$10$rmvKCTl1GBAmqLEtwmbEJOfXrcOSeHQl1OlTaDEEPhyOOgh0RK6x6",BIN_URL:"https://api.jsonbin.io/v3/b/6825827b8561e97a50143be1"}});var b=x(),c=[],C=null;document.addEventListener("DOMContentLoaded",()=>{let k=document.getElementById("listLoader"),l=document.getElementById("entryContainer");k.innerHTML=`
    <div id="listHeader">
        <h2>Deine Listen</h2>
        <button id="addListButton">+</button>
    </div>
    <div id="listContainer">
        <!-- Dynamisch erzeugte Buttons f\xFCr jede Liste -->
    </div>
    `,document.getElementById("addListButton").addEventListener("click",()=>{let t=prompt("Wie soll die neue Liste hei\xDFen?");if(t&&t.trim()){let i={id:Date.now(),name:t.trim(),entries:[]};c.push(i),E(c),C=i.id,L(),v(i,!0)}});let D=document.getElementById("listContainer");fetch(b.BIN_URL,{headers:{"X-Master-Key":b.API_KEY}}).then(t=>t.json()).then(t=>{c=t.record,L()});function L(){D.innerHTML="",c.forEach(t=>{let i=document.createElement("button");i.textContent=t.name,i.id=`list_${t.id}`,t.id===C&&i.classList.add("active"),i.addEventListener("click",()=>{C=t.id,v(t,!1),L()}),D.appendChild(i)})}function v(t,i=!1){l.innerHTML=`<h2>${t.name}</h2><ul></ul>`;let d=l.querySelector("ul"),m=t.entries.filter(e=>e.active),r=t.entries.filter(e=>!e.active);function s(e){let n=document.createElement("li"),o=document.createElement("input");o.type="checkbox",o.id=`entry_${e.id}`,o.checked=!e.active;let h=document.createElement("label");return h.htmlFor=o.id,h.textContent=e.name,n.appendChild(o),n.appendChild(h),n.classList.toggle("checked",o.checked),e.active&&(n.draggable=!0,n.addEventListener("dragstart",a=>{n.classList.add("dragging"),a.dataTransfer.setData("text/plain",e.id)}),n.addEventListener("dragend",()=>{n.classList.remove("dragging")})),o.addEventListener("change",()=>{let a=c.find(g=>g.id===t.id),I=a.entries.find(g=>g.id===e.id);I.active=!o.checked,E(c),v(a)}),n.addEventListener("click",a=>{a.target===n&&o.click()}),n}if(m.forEach(e=>{d.appendChild(s(e))}),d.addEventListener("dragover",e=>{e.preventDefault();let n=d.querySelector(".dragging"),o=N(d,e.clientY);if(o==null){let h=d.querySelector("hr:nth-last-of-type(2)");h?d.insertBefore(n,h):d.appendChild(n)}else d.insertBefore(n,o)}),d.addEventListener("drop",()=>{let e=c.find(a=>a.id===t.id),n=[];d.querySelectorAll("li:not(.checked):not(.dummy-entry)").forEach(a=>{let I=a.querySelector("input[type='checkbox']").id.replace("entry_",""),g=e.entries.find(_=>_.id==I);g&&n.push(g)});let h=e.entries.filter(a=>!a.active);e.entries=[...n,...h],E(c)}),r.length>0){let e=document.createElement("hr");d.appendChild(e)}r.forEach(e=>{d.appendChild(s(e))});let u=document.createElement("hr");d.appendChild(u),T(t,d,i);let B=document.createElement("hr");d.appendChild(B);let f=document.createElement("div");f.className="button-row";let p=document.createElement("button");p.textContent="\u2714 Abgehakte l\xF6schen",p.className="clear-checked-button",p.addEventListener("click",()=>{if(confirm("Wirklich alle abgehakten Eintr\xE4ge l\xF6schen?")){let e=c.find(n=>n.id===t.id);e.entries=e.entries.filter(n=>n.active),E(c),v(e,!1)}});let y=document.createElement("button");y.textContent="Liste l\xF6schen \u{1F5D1}",y.className="delete-button",y.addEventListener("click",()=>{confirm("Diese Liste wirklich l\xF6schen?")&&(c=c.filter(e=>e.id!==t.id),E(c),l.innerHTML="",l.classList.add("hidden"),C=null,L())}),f.appendChild(p),f.appendChild(y),l.appendChild(f),l.classList.remove("hidden")}function N(t,i){return[...t.querySelectorAll("li:not(.checked):not(.dummy-entry):not(.dragging)")].reduce((m,r)=>{let s=r.getBoundingClientRect(),u=i-s.top-s.height/2;return u<0&&u>m.offset?{offset:u,element:r}:m},{offset:Number.NEGATIVE_INFINITY}).element}function T(t,i,d=!1){let m=document.createElement("li");m.classList.add("dummy-entry");let r=document.createElement("input");r.type="text",r.placeholder="Neuen Eintrag hinzuf\xFCgen...",r.classList.add("dummy-input");let s=document.createElement("button");s.textContent="\u{1F4BE}",s.classList.add("save-entry-button"),r.addEventListener("input",()=>{s.style.display=r.value.trim()?"inline-block":"none"}),r.addEventListener("keydown",u=>{u.key==="Enter"&&(u.preventDefault(),s.click())}),s.addEventListener("click",()=>{let u=r.value.trim();if(!u)return;let B={id:w(),name:u,active:!0},f=c.find(p=>p.id===t.id);f.entries.push(B),E(c),v(f,!0)}),m.appendChild(r),m.appendChild(s),i.appendChild(m),d&&setTimeout(()=>r.focus(),100)}function E(t){fetch(b.BIN_URL,{method:"PUT",headers:{"Content-Type":"application/json","X-Master-Key":b.API_KEY,"X-Bin-Versioning":!1},body:JSON.stringify(t)}).then(i=>i.json()).then(i=>{console.log("Speichern erfolgreich:",i)}).catch(i=>{console.error("Fehler beim Speichern:",i)})}function w(){return"_"+Math.random().toString(36).substr(2,9)}});})();
