(()=>{var N=(k,l)=>()=>(l||k((l={exports:{}}).exports,l),l.exports);var T=N((q,M)=>{M.exports={BIN_ID:"6825827b8561e97a50143be1",API_KEY:"$2a$10$rmvKCTl1GBAmqLEtwmbEJOfXrcOSeHQl1OlTaDEEPhyOOgh0RK6x6",BIN_URL:"https://api.jsonbin.io/v3/b/6825827b8561e97a50143be1"}});var b=T(),d=[],C=null;document.addEventListener("DOMContentLoaded",()=>{let k=document.getElementById("listLoader"),l=document.getElementById("entryContainer");k.innerHTML=`
    <div id="listHeader">
        <h2>Deine Listen</h2>
        <button id="addListButton">+</button>
    </div>
    <div id="listContainer">
        <!-- Dynamisch erzeugte Buttons f\xFCr jede Liste -->
    </div>
    `,document.getElementById("addListButton").addEventListener("click",()=>{let e=prompt("Wie soll die neue Liste hei\xDFen?");if(e&&e.trim()){let r={id:Date.now(),name:e.trim(),entries:[]};d.push(r),E(d),C=r.id,v(),L(r,!0)}});let B=document.getElementById("listContainer");fetch(b.BIN_URL,{headers:{"X-Master-Key":b.API_KEY}}).then(e=>e.json()).then(e=>{d=e.record.filter(r=>Object.keys(r).length>0),v()});function v(){B.innerHTML="",d.length===0&&(B.innerHTML=`
                <p>Es sind noch keine Listen vorhanden.<br>
                Erstelle eine neue \xFCber den (+)-Button oben rechts!</p>
            `),d.forEach(e=>{let r=document.createElement("button");r.textContent=e.name,r.id=`list_${e.id}`,e.id===C&&r.classList.add("active"),r.addEventListener("click",()=>{C=e.id,L(e,!1),v()}),B.appendChild(r)})}function L(e,r=!1){l.innerHTML=`<h2>${e.name}</h2><ul></ul>`;let n=l.querySelector("ul"),m=e.entries.filter(t=>t.active),c=e.entries.filter(t=>!t.active);function o(t){let i=document.createElement("li"),s=document.createElement("input");s.type="checkbox",s.id=`entry_${t.id}`,s.checked=!t.active;let h=document.createElement("label");return h.htmlFor=s.id,h.textContent=t.name,i.appendChild(s),i.appendChild(h),i.classList.toggle("checked",s.checked),t.active&&(i.draggable=!0,i.addEventListener("dragstart",a=>{i.classList.add("dragging"),a.dataTransfer.setData("text/plain",t.id)}),i.addEventListener("dragend",()=>{i.classList.remove("dragging")})),s.addEventListener("change",()=>{let a=d.find(g=>g.id===e.id),D=a.entries.find(g=>g.id===t.id);D.active=!s.checked,E(d),L(a)}),i.addEventListener("click",a=>{a.target===i&&s.click()}),i}if(m.forEach(t=>{n.appendChild(o(t))}),n.addEventListener("dragover",t=>{t.preventDefault();let i=n.querySelector(".dragging"),s=x(n,t.clientY);if(s==null){let h=n.querySelector("hr:nth-last-of-type(2)");h?n.insertBefore(i,h):n.appendChild(i)}else n.insertBefore(i,s)}),n.addEventListener("drop",()=>{let t=d.find(a=>a.id===e.id),i=[];n.querySelectorAll("li:not(.checked):not(.dummy-entry)").forEach(a=>{let D=a.querySelector("input[type='checkbox']").id.replace("entry_",""),g=t.entries.find(_=>_.id==D);g&&i.push(g)});let h=t.entries.filter(a=>!a.active);t.entries=[...i,...h],E(d)}),c.length>0){let t=document.createElement("hr");n.appendChild(t)}c.forEach(t=>{n.appendChild(o(t))});let u=document.createElement("hr");n.appendChild(u),A(e,n,r);let I=document.createElement("hr");n.appendChild(I);let f=document.createElement("div");f.className="button-row";let p=document.createElement("button");p.textContent="\u2714 Abgehakte l\xF6schen",p.className="clear-checked-button",p.addEventListener("click",()=>{if(confirm("Wirklich alle abgehakten Eintr\xE4ge l\xF6schen?")){let t=d.find(i=>i.id===e.id);t.entries=t.entries.filter(i=>i.active),E(d),L(t,!1)}});let y=document.createElement("button");y.textContent="Liste l\xF6schen \u{1F5D1}",y.className="delete-button",y.addEventListener("click",()=>{confirm("Diese Liste wirklich l\xF6schen?")&&(d=d.filter(t=>t.id!==e.id),E(d),l.innerHTML="",l.classList.add("hidden"),C=null,v())}),f.appendChild(p),f.appendChild(y),l.appendChild(f),l.classList.remove("hidden")}function x(e,r){return[...e.querySelectorAll("li:not(.checked):not(.dummy-entry):not(.dragging)")].reduce((m,c)=>{let o=c.getBoundingClientRect(),u=r-o.top-o.height/2;return u<0&&u>m.offset?{offset:u,element:c}:m},{offset:Number.NEGATIVE_INFINITY}).element}function A(e,r,n=!1){let m=document.createElement("li");m.classList.add("dummy-entry");let c=document.createElement("input");c.type="text",c.placeholder="Neuen Eintrag hinzuf\xFCgen...",c.classList.add("dummy-input");let o=document.createElement("button");o.textContent="\u{1F4BE}",o.classList.add("save-entry-button"),c.addEventListener("input",()=>{o.style.display=c.value.trim()?"inline-block":"none"}),c.addEventListener("keydown",u=>{u.key==="Enter"&&(u.preventDefault(),o.click())}),o.addEventListener("click",()=>{let u=c.value.trim();if(!u)return;let I={id:w(),name:u,active:!0},f=d.find(p=>p.id===e.id);f.entries.push(I),E(d),L(f,!0)}),m.appendChild(c),m.appendChild(o),r.appendChild(m),n&&setTimeout(()=>c.focus(),100)}function E(e){let r=Array.isArray(e)&&e.length===0?[{}]:e;fetch(b.BIN_URL,{method:"PUT",headers:{"Content-Type":"application/json","X-Master-Key":b.API_KEY,"X-Bin-Versioning":!1},body:JSON.stringify(r)}).then(n=>n.json()).then(n=>{console.log("Speichern erfolgreich:",n)}).catch(n=>{console.error("Fehler beim Speichern:",n)})}function w(){return"_"+Math.random().toString(36).substr(2,9)}});})();
